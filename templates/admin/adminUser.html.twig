{% extends 'base.admin.html.twig' %}

{% block title %}Admin Panel{% endblock %}

{% block admin_body %}
<style>
    .admin-users-wrapper {
        padding: 20px;
    }
    .admin-users-title {
        color: #61c087;
        margin-bottom: 20px;
    }
    .admin-users-subtitle {
        color: #757575;
        line-height: 1.6;
    }
    .admin-users-list {
        margin-top: 20px;
    }
    .admin-users-list a {
        display: block;
        margin-bottom: 10px;
        color: #000;
        text-decoration: none;
    }
    .admin-users-list a:hover {
        color: #61c087;
    }
    .admin-users-image {
        width: 60%;
        height: auto;
        margin-top: 20px;
    }
</style>

<div class="row justify-content-center admin-users-wrapper">
    <h2 class="admin-users-title">Modération des comptes utilisateurs</h2>
    <h4 class="admin-users-subtitle">
        Il s'agit de la liste des utilisateurs inscrits sur Dealo, vous pouvez prendre des actions sur ces utilisateurs.
    </h4>
    <div class="rounded-3 shadow-lg" style="min-width: 63vw;">
        <div class="card-body">
            <h4 class="card-title">Liste des utilisateurs</h4>
            <p class="card-title-desc">
                Il s'agit de la liste des utilisateurs inscrits sur Dealo, vous pouvez prendre des actions sur ces utilisateurs.
            </p>
            <div class="table-responsive">
                {% if users|length >= 1 %}
                    <table class="table table-editable table-nowrap align-middle table-edits w-100">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Nom et prénom</th>
                                <th>Pseudo</th>
                                <th>Email</th>
                                <th>Contact</th>
                                <th>Crée le</th>
                                <th>Statut du compte</th>
                                <th>Banni ?</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for user in users %}
                                <tr style="
                                    background-color: {% if 'ROLE_BANNED' in user.roles %}#f8d7da{% elseif 'ROLE_ADMIN' in user.roles %}#efe1ac{% endif %};
                                ">
                                    <td>{{ user.id }}</td>
                                    <td>{{ user.firstName }} {{ user.lastName }}</td>
                                    <td>{{ user.username }}</td>
                                    <td>{{ user.email }}</td>
                                    <td>{{ user.phone ? user.phone : 'N/a' }}</td>
                                    <td> {{ user.createdAt|date('d/m/Y') }}</td>
                                    <td>
                                        {% if 'ROLE_ADMIN' in user.roles %}
                                            Administrateur
                                        {% elseif 'ROLE_USER' in user.roles %}
                                            Utilisateur
                                        {% elseif 'ROLE_BANNED' in user.roles %}
                                            Banni
                                        {% endif %}
                                    </td>
                                    <td>{{ 'ROLE_BANNED' in user.roles ? 'Oui' : 'Non' }}</td>
                                    <td style="width: 100px;">
                                        <a class="btn btn-outline-secondary btn-sm" href="mailto:{{ user.email }}" title="Contacter">
                                            <i class="fas fa-envelope" style="color: green;"></i>
                                        </a>
                                        {% if 'ROLE_BANNED' in user.roles %}
                                            <a class="btn btn-outline-secondary btn-sm mx-1" href="{{ path('admin_unban_user', { 'id': user.id }) }}" title="Dé-bannir">
                                                <i class="fas fa-undo" style="color: blue;"></i>
                                            </a>
                                        {% else %}
                                            <a class="btn btn-outline-secondary btn-sm mx-1" href="{{ path('admin_ban_user', { 'id': user.id }) }}" title="Bannir">
                                                <i class="fas fa-ban" style="color: red;"></i>
                                            </a>
                                        {% endif %}
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <div class="text-center fs-3">Aucun utilisateur trouvé</div>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}